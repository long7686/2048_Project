{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/GameManagaer.js"],"names":["ROWS","DIRECTION","cc","Enum","RIGHT","LEFT","UP","DOWN","MIN_LENGTH","Class","extends","Component","properties","scoreLabel","Label","bestScoreLabel","blockPrefab","Prefab","bgBox","Node","cellPrefab","loseLayOut","winLayOut","_gap","default","serializable","_blockSize","_data","_arrBlock","_posisions","_score","_canMove","_startPoint","_endPoint","_firstX","_firstY","_endX","_endY","_vector","_isTouch","_isCLick","onLoad","active","start","width","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","eventHandler","getScoreStorge","blockInit","init","arrInit","x","y","blockArr","Array","i","j","updateScore","row","col","getComponent","setNumber","addBlock","push","height","block","instantiate","parent","setPosition","v2","getEmptyLocations","locations","length","location","Math","floor","random","position","number","num","string","event","getLocation","log","reflectTouch","mouseEvent","startVec","endVec","pointsVec","sub","vecLength","mag","abs","touchEvent","keyCode","macro","KEY","right","blockMoveRight","left","blockMoveLeft","up","blockMoveUp","down","blockMoveDown","direction","afterMove","hasMoved","checkScore","checkGameOver","gameOver","moveBlock","callback","action","moveTo","finish","callFunc","runAction","sequence","combineBlock","b1","b2","destroy","scale1","scaleTo","scale2","mid","n","move","toMove","count","tween","node","to","opacity","gameWin","onRestartClick","onContinueClick","scoreStorge","sys","localStorage","getItem","JSON","parse","newScore","parseInt","setItem","stringify"],"mappings":"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","file":"GameManagaer.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const ROWS = 4;\nconst DIRECTION = cc.Enum({\n    RIGHT: -1,\n    LEFT: -1,\n    UP: -1,\n    DOWN: -1\n});\nconst MIN_LENGTH = 20;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        scoreLabel : cc.Label,\n        bestScoreLabel : cc.Label,\n        blockPrefab : cc.Prefab,\n        bgBox : cc.Node,\n        cellPrefab : cc.Prefab,\n        loseLayOut: cc.Node,\n        winLayOut: cc.Node,\n\n        _gap :{\n            default : 10,\n            serializable : false,\n        },\n        _blockSize : null,\n        _data: [],\n        _arrBlock : [],\n        _posisions : [],\n        _score : null,\n        _canMove : true,\n        _startPoint : null,\n        _endPoint : null,\n        _firstX : null,\n        _firstY : null,\n        _endX : null,\n        _endY : null,\n        _vector : null,\n        _isTouch : true,\n        _isCLick : true,\n    },\n\n    onLoad(){\n        this._canMove = true;\n        this.loseLayOut.active = false;\n        this._isTouch = true;\n        this._isCLick = true;\n    },\n    \n    start () {\n        this._blockSize = (this.bgBox.width - this._gap * 5) / 4;\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        \n        this.eventHandler();\n        this.getScoreStorge();\n        this.blockInit();\n        this.init();\n    },\n\n    arrInit(x, y){\n        let blockArr = new Array();\n        for (let i = 0; i < x; i++) {\n            blockArr[i] = new Array();\n            for (let j = 0; j < y; j++) {\n                blockArr[i][j] = 0;\n            }\n        }\n        return blockArr;\n    },\n\n    init(){\n        this.updateScore(0);\n        this._data = this. arrInit(ROWS, ROWS);\n        for (let row = 0; row < ROWS; row++) {\n            for (let col = 0; col < ROWS; col++) {\n                this._arrBlock[row][col].getComponent(\"BlockController\").setNumber(0);    \n                this._data[row][col] = 0;            \n            }\n        };   \n        this.addBlock();\n        this.addBlock();\n    },\n\n    blockInit(){\n        this._arrBlock = this.arrInit(ROWS, ROWS);\n\n        for(let i = 0; i < ROWS; i++){\n            this._posisions.push([0,0,0,0]);\n            for(let j = 0; j < ROWS; j++){\n                let x = -(this.bgBox.width / 2) + (this._gap * (j + 1) + this._blockSize / 2 * (2 * j + 1));\n                let y = (this.bgBox.height / 2) - (this._gap * (i + 1) + this._blockSize / 2 * (2 * i + 1));\n                let block = cc.instantiate(this.blockPrefab);\n                block.parent = this.bgBox;\n                block.width = this._blockSize;\n                block.height = this._blockSize;\n                block.setPosition(cc.v2(x, y));\n                this._posisions[i][j] = (cc.v2(x, y));\n                block.getComponent(\"BlockController\").setNumber(0);\n                this._arrBlock[i][j] = (block);\n            }\n        }\n       \n    },\n\n    getEmptyLocations(){\n        let locations = [];\n        for (let row = 0; row < ROWS; row++) {\n            for (let col = 0; col < ROWS; col++) {\n                if(this._data[row][col] === 0){\n                    locations.push({\n                        x : row,\n                        y : col,\n                    })\n                }                \n            }\n        }\n        return locations;\n    },\n\n    addBlock(){\n        let locations = this.getEmptyLocations();\n        if(locations.length === 0) return false;\n\n        let location = locations[Math.floor(Math.random() * locations.length)];\n        let x = location.x;\n        let y = location.y;\n        let position = this._posisions[x][y];\n        let block = cc.instantiate(this.blockPrefab);\n        block.width = this._blockSize;\n        block.height = this._blockSize;\n        block.parent = this.bgBox;\n        block.setPosition(position);\n        \n        let number = Math.random() <= 0.95 ? 2 : 4;\n        block.getComponent(\"BlockController\").setNumber(number);\n        this._arrBlock[x][y] = block;\n        this._data[x][y] = number;\n\n        return true;\n    },\n\n    updateScore(num){\n        this._score = num;\n        this.scoreLabel.string = num;\n    },\n\n    eventHandler(){\n        if(this._isTouch){\n            this.bgBox.on(\"touchstart\", (event)=>{\n                this._startPoint = event.getLocation();\n                this._isCLick = false;\n                cc.log(this._isCLick)\n            })\n            this.bgBox.on(\"touchend\", (event) =>{\n                this._endPoint = event.getLocation();\n                this.reflectTouch();\n                this._isCLick = true;\n            })\n            this.bgBox.on(\"touchcancel\", (event) =>{\n                this._endPoint = event.getLocation();\n                this.reflectTouch();\n                this._isCLick = true;\n            })\n        }\n        if(this._isCLick){\n            this.bgBox.on(\"mousedown\", (event) =>{\n                this._startPoint = event.getLocation();\n                this._firstX = this._startPoint.x;\n                this._firstY = this._startPoint.y;\n                this._isTouch = false;\n                cc.log(this._isTouch)\n            })\n            this.bgBox.on(\"mouseup\", (event) =>{\n                this._endPoint = event.getLocation();\n                this._endX = this._startPoint.x - this._endPoint.x;\n                this._endY = this._startPoint.y - this._endPoint.y;\n                this._vector = cc.v2(this._endX, this._endY);\n                this.mouseEvent();\n                cc.log(this._vector.y)\n                this._isTouch = true;\n            })\n        }\n    },\n\n    reflectTouch(){\n        let startVec = this._startPoint;\n        let endVec = this._endPoint;\n        let pointsVec = endVec.sub(startVec);\n        let vecLength = pointsVec.mag();\n        if(vecLength > MIN_LENGTH){\n            if(Math.abs(pointsVec.x) > Math.abs(pointsVec.y)) {\n                if(pointsVec.x > 0) this.touchEvent(DIRECTION.RIGHT);\n                else this.touchEvent(DIRECTION.LEFT);\n            }else{\n                if(pointsVec.y > 0) this.touchEvent(DIRECTION.UP);\n                else this.touchEvent(DIRECTION.DOWN);\n            }\n        }\n    },\n\n    onKeyDown(event){\n        switch (event.keyCode) {\n            case cc.macro.KEY.right:\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveRight();\n                }\n                break;\n            case cc.macro.KEY.left:\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveLeft();\n                }\n                \n                break;\n            case cc.macro.KEY.up:\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveUp();\n                }\n                break;\n            case cc.macro.KEY.down:\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveDown();\n                }\n                break;\n        };\n       \n    },\n\n    touchEvent(direction){\n        switch(direction){\n            case DIRECTION.RIGHT: {\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveRight();\n                }\n                break;\n            }\n            case DIRECTION.LEFT: {\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveLeft();\n                }\n                break;\n            }\n            case DIRECTION.UP: {\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveUp();\n                }\n                break;\n            }\n            case DIRECTION.DOWN: {\n                if(this._canMove){\n                    this._canMove = false\n                    this.blockMoveDown();\n                }\n                break;\n            }\n        }\n    },\n\n    mouseEvent(){\n            if(this._vector.x < 0 && this._vector.y < 50 && this._vector.y > -50){\n                this._canMove = false\n                this.blockMoveRight();\n                cc.log(\"Right\")\n            }else if(this._vector.x > 0 && this._vector.y < 50 && this._vector.y > -50){\n                this._canMove = false\n                this.blockMoveLeft();\n                cc.log(\"Left\")\n            }\n            if(this._vector.y < 0 && this._vector.x < 50 && this._vector.x > -50){\n                this._canMove = false\n                this.blockMoveUp();\n                cc.log(\"Up\")\n                cc.log(this._vector.y)\n            }else if(this._vector.y > 0 && this._vector.x < 50 && this._vector.x > -50){\n                cc.log(\"Down\")\n                cc.log(this._vector.y)\n                this._canMove = false\n                this.blockMoveDown();\n            }\n    },\n\n    afterMove(hasMoved){\n        this._canMove = true\n        if(hasMoved){\n            this.updateScore(this._score + 1);\n            this.addBlock();\n            this.checkScore();\n        }\n        else if(this.checkGameOver()){\n            this.gameOver()\n        }\n    },\n\n    moveBlock(block, position, callback){\n        let action = cc.moveTo(.05, position);\n        let finish = cc.callFunc(()=>{\n            callback && callback();\n        })\n        block.runAction(cc.sequence(action, finish,));\n    },\n\n    combineBlock(b1, b2, num, callback){\n        b1.destroy();\n        let scale1 = cc.scaleTo(0.1, 1.1);\n        let scale2 = cc.scaleTo(0.1, 1);\n        let mid = cc.callFunc(()=>{\n            b2.getComponent(\"BlockController\").setNumber(num);\n        });\n        let finish = cc.callFunc(()=>{\n            callback && callback();\n        })\n        b2.runAction(cc.sequence(scale1, mid, scale2, finish));\n    },\n\n    checkGameOver(){  \n        for (let i = 0; i < ROWS; i++) {\n            for (let j = 0; j < ROWS; j++) {\n                let n = this._data[i][j];\n                if(n === 0) return false;\n                if(j > 0 && this._data[i][j - 1] == n) return false;\n                if(j < ROWS - 1 && this._data[i][j + 1] == n) return false;\n                if(i > 0 && this._data[i - 1][j] == n) return false;\n                if(i < ROWS - 1 && this._data[i + 1][j] == n) return false; \n                \n            }       \n        }\n        return true;\n    },\n\n    blockMoveRight(){\n        let hasMoved = false;\n        let move = (x ,y ,callback) =>{\n            if(y == ROWS + 1 || this._data[x][y] == 0){\n                callback && callback();\n                return;\n            }else if(this._data[x][y + 1] == 0){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x][y + 1];\n                this._arrBlock[x][y + 1] = block;\n                this._data[x][y + 1] = this._data[x][y];\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null;\n                this.moveBlock(block, position, ()=>{\n                    move(x, y + 1, callback);\n                });\n                hasMoved = true;\n            }else if(this._data[x][y + 1] == this._data[x][y]){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x][y + 1];\n               \n                this._data[x][y + 1] *= 2;\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null\n                this.moveBlock(block, position, ()=>{\n                    this.combineBlock(block, this._arrBlock[x][y + 1], this._data[x][y + 1],()=>{\n                        callback && callback();\n                    })\n                });\n                hasMoved = true;\n            }else{\n                callback && callback();\n                return;\n            }\n        }\n        \n        let toMove = [];\n        for (let i = 0; i < ROWS; i++) {\n            for (let j = ROWS - 1; j >= 0; j--){\n                if(this._data[i][j] != 0){\n                    toMove.push({\n                        x : i,\n                        y : j,\n                    });\n                }\n            }\n        }\n\n        let count = 0;\n        for (let i = 0; i < toMove.length; i++) {\n            move(toMove[i].x, toMove[i].y, ()=>{\n                count ++;\n                if(count == toMove.length){\n                    this.afterMove(hasMoved);\n                }\n            })\n        }\n    },\n\n    blockMoveLeft(){\n        let hasMoved = false;\n        let move = (x ,y ,callback) =>{\n            if(y == 0 || this._data[x][y] == 0){\n                callback && callback();\n                return;\n            }else if(this._data[x][y - 1] == 0){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x][y - 1];\n                this._arrBlock[x][y - 1] = block;\n                this._data[x][y - 1] = this._data[x][y];\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null;\n                this.moveBlock(block, position, ()=>{\n                    move(x, y - 1, callback);\n                });\n                hasMoved = true;\n            }else if(this._data[x][y - 1] == this._data[x][y]){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x][y - 1];\n               \n                this._data[x][y - 1] *= 2;\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null\n                this.moveBlock(block, position, ()=>{\n                    this.combineBlock(block, this._arrBlock[x][y - 1], this._data[x][y - 1],()=>{\n                        callback && callback();\n                    })\n                });\n                hasMoved = true;\n            }else{\n                callback && callback();\n                return;\n            }\n        }\n        let toMove = [];\n        for (let i = 0; i < ROWS; i++) {\n            for (let j = 0; j < ROWS; j++){\n                if(this._data[i][j] != 0){\n                    toMove.push({\n                        x : i,\n                        y : j,\n                    });\n                }\n            }\n        }\n\n        let count = 0;\n        for (let i = 0; i < toMove.length; i++) {\n            move(toMove[i].x, toMove[i].y, ()=>{\n                count ++;\n                if(count == toMove.length){\n                    this.afterMove(hasMoved);\n                }\n            })\n        }\n    },\n\n    blockMoveDown(){\n        let hasMoved = false;\n        let move = (x ,y ,callback) =>{\n            if(x == ROWS - 1  || this._data[x][y] == 0){\n                callback && callback();\n                return;\n            }else if(this._data[x + 1][y] == 0){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x + 1][y];\n                this._arrBlock[x + 1][y] = block;\n                this._data[x + 1][y] = this._data[x][y];\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null;\n                this.moveBlock(block, position, ()=>{\n                    move(x + 1, y, callback);\n                });\n                hasMoved = true;\n            }else if(this._data[x + 1][y] == this._data[x][y]){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x + 1][y];\n               \n                this._data[x + 1][y] *= 2;\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null\n                this.moveBlock(block, position, ()=>{\n                    this.combineBlock(block, this._arrBlock[x + 1][y], this._data[x + 1][y],()=>{\n                        callback && callback();\n                    })\n                });\n                hasMoved = true;\n            }else{\n                callback && callback();\n                return;\n            }\n        }\n        let toMove = [];\n        for (let i = ROWS - 1; i >= 0; i--) {\n            for (let j = 0; j < ROWS; j++){\n                if(this._data[i][j] != 0){\n                    toMove.push({\n                        x : i,\n                        y : j,\n                    });\n                }\n            }\n        }\n        let count = 0;\n        for (let i = 0; i < toMove.length; i++) {\n            move(toMove[i].x, toMove[i].y, ()=>{\n                count ++;\n                if(count == toMove.length){\n                    this.afterMove(hasMoved);\n                }\n            })\n        }\n    },\n\n    blockMoveUp(){\n        let hasMoved = false;\n        let move = (x ,y ,callback) =>{\n            if(x == 0  || this._data[x][y] == 0){\n                callback && callback();\n                return;\n            }else if(this._data[x - 1][y] == 0){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x - 1][y];\n                this._arrBlock[x - 1][y] = block;\n                this._data[x - 1][y] = this._data[x][y];\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null;\n                this.moveBlock(block, position, ()=>{\n                    move(x - 1, y, callback);\n                });\n                hasMoved = true;\n            }else if(this._data[x - 1][y] == this._data[x][y]){\n                let block = this._arrBlock[x][y];\n                let position = this._posisions[x - 1][y];\n               \n                this._data[x - 1][y] *= 2;\n                this._data[x][y] = 0;\n                this._arrBlock[x][y] = null\n                this.moveBlock(block, position, ()=>{\n                    this.combineBlock(block, this._arrBlock[x - 1][y], this._data[x - 1][y],()=>{\n                        callback && callback();\n                    })\n                });\n                hasMoved = true;\n            }else{\n                callback && callback();\n                return;\n            }\n        }\n        let toMove = [];\n        for (let i = 0; i < ROWS; i++) {\n            for (let j = 0; j < ROWS; j++){\n                if(this._data[i][j] != 0){\n                    toMove.push({\n                        x : i,\n                        y : j,\n                    });\n                }\n            }\n        }\n        let count = 0;\n        for (let i = 0; i < toMove.length; i++) {\n            move(toMove[i].x, toMove[i].y, ()=>{\n                count ++;\n                if(count == toMove.length){\n                    this.afterMove(hasMoved);\n                }\n            })\n        }\n    },\n\n    gameOver(){\n        cc.tween(this.node)\n            .to(.5,{opacity:150})\n            .start()\n        this.loseLayOut.active = true;\n    },\n\n    gameWin(){\n        this._canMove = false;\n        cc.tween(this.node)\n            .to(.5,{opacity:150})\n            .start()\n        this.winLayOut.active = true;\n    },\n\n    onRestartClick(){\n        this._canMove = true;\n        this.blockInit();\n        this.init();\n        this.node.opacity = 255;\n        this.loseLayOut.active = false\n        this.winLayOut.active = false\n    },\n\n    onContinueClick(){\n        this._canMove = true;\n        this.node.opacity = 255;\n        this.winLayOut.active = false\n    },\n\n    getScoreStorge(){\n        let scoreStorge = cc.sys.localStorage.getItem('bestScore');\n        if(scoreStorge !== null){\n            this.bestScoreLabel.string = JSON.parse(scoreStorge);\n        }else{\n            this.bestScoreLabel.string = 0;\n        }\n    },\n\n    checkScore(){\n        let newScore = parseInt(this.scoreLabel.string);\n        if(newScore > this.bestScoreLabel.string){\n            cc.sys.localStorage.setItem('bestScore', JSON.stringify(newScore));\n            this.bestScoreLabel.string = newScore;\n        }\n    },\n\n});\n"]}